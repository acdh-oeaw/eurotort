{% extends "base.html" %}
{% load static %}
{% load django_tables2 %}
{% load crispy_forms_field %}
{% load crispy_forms_tags %}
{% block title %} Browse {{ class_name }} {% endblock %}
{% block scriptHeader %}

{% endblock %}
{% block content %}
{% include 'archiv/partials/listview_breadcrumb.html' %}
<div class="container">
    <h1 class="text-center p-3">{{ object_list|length }} {{ verbose_name_plural }}</h1>
    <div class="input-group mb-3 d-flex align-items-center justify-content-center">
        <input class="input-group-text" type="text" id="myInput" onkeyup="myFunction()" placeholder="Type to filter ...">
        <span class="input-group-text" id="basic-addon1"><i class="bi bi-search"></i></span>
    </div>
    <div id="filterMe" class="pt-2">
        <dl class="multi-column-dl">
        {% for key, value in grouped_items.items %}
            <dt>{{ key }}</dt>
            {% for x in value %}
            <dd><a href="/archive/author/detail/{{ x.id }}">{{ x.name }}</a></dd>
            {% endfor %}
        {% endfor %}
        </dl>
    </div>
</div>
<script>
    function myFunction() {
      const input = document.getElementById('myInput');
      const filter = input.value.toLowerCase();
      const container = document.getElementById('filterMe');
      const items = container.querySelectorAll('dd');
      const terms = container.querySelectorAll('dt');
      
      // Filter dd elements
      items.forEach(item => {
        const text = item.textContent || item.innerText;
        if (text.toLowerCase().indexOf(filter) > -1) {
          item.style.display = '';
        } else {
          item.style.display = 'none';
        }
      });
      
      // Hide dt elements if they have no visible dd siblings
      terms.forEach(term => {
        let nextElement = term.nextElementSibling;
        let hasVisibleDd = false;
        
        while (nextElement && nextElement.tagName === 'DD') {
          if (nextElement.style.display !== 'none') {
            hasVisibleDd = true;
            break;
          }
          nextElement = nextElement.nextElementSibling;
        }
        
        term.style.display = hasVisibleDd ? '' : 'none';
      });
    }
  </script>
{% endblock %}